plan "bosc_IFU";

    # ========================================
    # DUT测试API分组
    # ========================================
    feature "FG-API";
        description = "DUT测试API分组，提供IFU的基本操作接口，包括正常取指流程、复位、使能等核心功能"

        feature "FC-BASIC-OP";
            description = "IFU基本操作功能，提供DUT支持的各种基本操作接口。这些操作是IFU功能验证的基础"

            feature "CK-NORMAL-FETCH";
                description = "正常取指检测点。验证从ICache正常获取64字节指令块并处理的完整流程，包括S0计算范围、S1指令定界、S2预译码、S3发送到IBuffer的全过程"
            endfeature

            feature "CK-RESET";
                description = "复位功能检测点。验证系统复位时IFU所有流水线级（S0、S1、S2、S3）和状态机正确复位到初始状态，所有寄存器清零"
            endfeature

            feature "CK-FLUSH";
                description = "冲刷功能检测点。验证接收到冲刷信号时IFU正确清空流水线并恢复到初始状态，包括流水线寄存器复位、状态寄存器处理、IBuffer指针复位"
            endfeature

            feature "CK-IDLE";
                description = "空闲状态检测点。验证无取指请求时IFU保持空闲状态，不产生无效输出，保持各流水线级稳定"
            endfeature

            feature "CK-ENABLE";
                description = "使能控制检测点。验证IFU使能信号控制功能生效情况，使能无效时暂停取指，使能有效时正常工作"
            endfeature
        endfeature
    endfeature

    # ========================================
    # 指令定界功能分组
    # ========================================
    feature "FG-INSTR-BOUNDARY";
        description = "指令定界功能分组，包含指令边界识别、RVC/RVI指令区分、跨预测块处理等指令定界相关功能"

        feature "FC-INSTR-BOUNDARY-BASIC";
            description = "基本指令定界功能。在64字节fetch块中识别每条指令的起始位置和结束位置，区分RVC（16位）和RVI（32位）指令。使用多路推断策略优化关键路径"

            feature "CK-RVC-ONLY";
                description = "纯RVC指令检测点。验证fetch块中只包含16位RVC指令时的定界正确性，最多32条RVC指令（16×32=512位=64字节）"
            endfeature

            feature "CK-RVI-ONLY";
                description = "纯RVI指令检测点。验证fetch块中只包含32位RVI指令时的定界正确性，最多16条RVI指令（32×16=512位=64字节）"
            endfeature

            feature "CK-MIXED";
                description = "RVC/RVI混合检测点。验证fetch块中RVC和RVI指令混合时的定界正确性，包括任意混合比例的情况"
            endfeature

            feature "CK-BOUNDARY-CORRECT";
                description = "边界正确性检测点。验证每条指令的起始边界（instrStart）和结束边界（instrEnd）计算正确，与指令长度匹配"
            endfeature

            feature "CK-32-ENTRY";
                description = "32条目边界检测点。验证fetch块中最多32条RVC指令时的边界计算，确保所有指令边界正确识别"
            endfeature
        endfeature

        feature "FC-INSTR-BOUNDARY-CROSS";
            description = "跨预测块定界功能。处理跨越预测块边界的指令识别，包括半条指令的处理和两个预测块的拼接"

            feature "CK-HALF-INSTR-FIRST";
                description = "第一个预测块半条检测点。验证第一个预测块最后一条指令跨越边界到第二个预测块的情况，半条指令暂存到下一个周期"
            endfeature

            feature "CK-HALF-INSTR-SECOND";
                description = "第二个预测块半条检测点。验证第二个预测块最后一条指令跨越边界的情况，需要处理半条指令的拼接"
            endfeature

            feature "CK-TWO-HALF";
                description = "两个半条指令检测点。验证两个预测块都存在半条指令的复杂情况，需要正确处理两个半条指令的拼接和定界"
            endfeature

            feature "CK-CROSS-PAGE";
                description = "跨页处理检测点。验证指令跨越页边界（4KB）时的定界和拼接，两个页的物理地址可能不连续"
            endfeature

            feature "CK-ALIGNMENT";
                description = "对齐处理检测点。验证跨预测块时指令对齐的正确性，确保半条指令与新预测块的指令正确拼接"
            endfeature
        endfeature
    endfeature

    # ========================================
    # 指令紧密排列功能分组
    # ========================================
    feature "FG-INSTR-COMPACT";
        description = "指令紧密排列功能分组。将稀疏的指令序列转换为紧密排列的形式，优化IBuffer存储空间"

        feature "FC-INSTR-COMPACT";
            description = "指令序列紧密化功能。将InstrBoundary模块输出的稀疏指令序列转换为紧密排列的指令序列，去除无效条目，保留有效指令"

            feature "CK-NORMAL-COMPACT";
                description = "正常紧密化检测点。验证无跨预测块时的指令紧密排列功能，将稀疏的valid指令序列转换为密集序列"
            endfeature

            feature "CK-CROSS-COMPACT";
                description = "跨预测块紧密化检测点。验证跨预测块时两个预测块的指令拼接和紧密排列，确保半条指令正确处理"
            endfeature

            feature "CK-HALF-HANDLE";
                description = "半条指令处理检测点。验证半条指令在紧密排列过程中的正确处理，确保半条指令与新预测块的指令正确拼接"
            endfeature

            feature "CK-VALID-MASK";
                description = "有效掩码检测点。验证有效掩码的正确计算和应用，确保只有有效指令参与紧密排列"
            endfeature

            feature "CK-8-ENTRY";
                description = "8条目输出检测点。验证输出8条紧密排列指令的正确性（IBufferEnqueueWidth=8），确保指令数据、PC、valid信号正确"
            endfeature
        endfeature
    endfeature

    # ========================================
    # 预译码功能分组
    # ========================================
    feature "FG-PREDECODE";
        description = "预译码功能分组。在指令发送到后端之前提前生成控制流信息，包括CFI类型、分支属性、跳转偏移量等"

        feature "FC-PREDECODE-CFI";
            description = "CFI类型识别功能。识别指令是否为控制流指令（CFI），包括jal、jalr、br、ret等指令类型"

            feature "CK-JAL";
                description = "jal指令检测点。验证识别jal指令（无条件跳转并链接）的正确性，jal指令属于直接跳转CFI"
            endfeature

            feature "CK-JALR";
                description = "jalr指令检测点。验证识别jalr指令（寄存器跳转并链接）的正确性，jalr指令属于间接跳转CFI"
            endfeature

            feature "CK-BRANCH";
                description = "br指令检测点。验证识别条件分支指令（beq、bne、blt、bge、bltu、bgeu等）的正确性"
            endfeature

            feature "CK-RET";
                description = "ret指令检测点。验证识别ret指令（函数返回）的正确性，ret指令是特殊的jalr指令（包含pop操作）"
            endfeature

            feature "CK-NON-CFI";
                description = "非CFI指令检测点。验证识别普通非控制流指令的正确性，确保非CFI指令不会被误判为CFI"
            endfeature
        endfeature

        feature "FC-PREDECODE-ATTR";
            description = "分支属性计算功能。计算分支指令的属性信息，包括是否直接跳转、是否包含返回指令等"

            feature "CK-IS-DIRECT";
                description = "直接跳转检测点。验证jal和br指令的isDirect属性正确设置，直接跳转指令的目标地址由PC+立即数计算"
            endfeature

            feature "CK-IS-INDIRECT";
                description = "间接跳转检测点。验证jalr指令的isIndirect属性正确设置，间接跳转指令的目标地址由寄存器值决定"
            endfeature

            feature "CK-HAS-POP";
                description = "包含返回检测点。验证ret指令（包含pop操作）的hasPop属性正确设置，用于识别返回指令"
            endfeature

            feature "CK-NOT-CFI";
                description = "非CFI属性检测点。验证非CFI指令的notCFI属性正确设置，用于后续检查非CFI指令被预测跳转的错误"
            endfeature
        endfeature

        feature "FC-PREDECODE-OFFSET";
            description = "跳转偏移量计算功能。计算jal和br指令的跳转偏移量，用于后续目的地址检查和预测纠正"

            feature "CK-JAL-OFFSET";
                description = "jal偏移检测点。验证jal指令的跳转偏移量计算，J型立即数格式：imm[20:10] | imm[9:0]，符号扩展到32位"
            endfeature

            feature "CK-BR-OFFSET";
                description = "br偏移检测点。验证br指令的跳转偏移量计算，B型立即数格式：imm[12] | imm[10:5] | imm[4:1] | imm[11]，符号扩展"
            endfeature

            feature "CK-SIGNEXT";
                description = "符号扩展检测点。验证偏移量的符号扩展正确性，确保负数偏移正确扩展"
            endfeature

            feature "CK-TARGET-ADDR";
                description = "目的地址检测点。验证PC+offset计算目的地址的正确性，用于检查预测目标地址是否正确"
            endfeature
        endfeature
    endfeature

    # ========================================
    # 预测检查功能分组
    # ========================================
    feature "FG-PREDCHECKER";
        description = "预测检查功能分组。采用两级流水线结构检测分支预测错误，及时纠正预测方向和目的地址错误"

        feature "FC-PREDCHECK-REMASK";
            description = "Stage 1：Remask Fault检测功能。检测需要重新掩码的错误，通过调整预测块范围来纠正预测方向错误"

            feature "CK-JAL-FAULT";
                description = "jal方向错误检测点。验证jal指令预测不跳转但实际应该跳转的错误检测，jal指令一定跳转（isDirect=true）"
            endfeature

            feature "CK-JALR-FAULT";
                description = "jalr方向错误检测点。验证jalr指令预测不跳转但实际应该跳转的错误检测，jalr指令一定跳转（isIndirect=true）"
            endfeature

            feature "CK-RET-FAULT";
                description = "ret方向错误检测点。验证ret指令预测不跳转但实际应该跳转的错误检测，ret指令一定跳转（hasPop=true）"
            endfeature

            feature "CK-NOT-CFI-FAULT";
                description = "非CFI跳转错误检测点。验证非控制流指令预测跳转的错误检测，非CFI指令不应该预测跳转"
            endfeature

            feature "CK-INVALID-TAKEN";
                description = "非法跳转检测点。验证预测跳转但指令末尾不在预测块边界内的错误检测，这种情况属于非法跳转"
            endfeature

            feature "CK-FIXED-RANGE";
                description = "范围修正检测点。验证根据remask fault调整预测块有效范围的正确性，只保留remaskIdx之前的指令"
            endfeature

            feature "CK-PRIORITY-ENC";
                description = "优先编码检测点。验证多个fault同时存在时优先处理第一个fault的正确性，使用ParallelPriorityEncoder选择第一个错误"
            endfeature
        endfeature

        feature "FC-PREDCHECK-REDIRECT";
            description = "Stage 2：重定向准备功能。基于Stage 1检测结果，准备详细的重定向信息用于FTQ写回"

            feature "CK-TARGET-FIX";
                description = "目的地址修正检测点。验证预测错误时计算正确目的地址，如果是跳转指令且非非法跳转使用jumpTargets，否则使用seqTargets"
            endfeature

            feature "CK-TAKEN-FIX";
                description = "跳转标志修正检测点。验证根据actual target和invalid taken修正taken标志的正确性，非法跳转不触发"
            endfeature

            feature "CK-REDIRECT-INFO";
                description = "重定向信息检测点。验证checkerRedirect信息的完整性，包括target、misIdx、taken、isRVC、attribute、selectBlock、invalidTaken、mispredPc、endOffset"
            endfeature

            feature "CK-FAULT-TYPE";
                description = "错误类型检测点。验证perfFaultType统计的7种错误类型正确性，包括NoFault、JalFault、JalrFault、RetFault、NotCfiFault、InvalidTaken、TargetFault"
            endfeature

            feature "CK-WBVALID";
                description = "写回有效检测点。验证wbValid控制信号的正确性，只有当wbValid为true时才输出有效的checkerRedirect"
            endfeature
        endfeature

        feature "FC-PREDCHECK-TARGET";
            description = "目的地址检查功能。检查分支指令的目的地址预测是否正确"

            feature "CK-FIRST-TARGET";
                description = "第一个目标检测点。验证第一个预测块的目的地址预测检查，比较actualTarget与firstPredTarget"
            endfeature

            feature "CK-SECOND-TARGET";
                description = "第二个目标检测点。验证第二个预测块的目的地址预测检查，比较actualTarget与secondPredTarget"
            endfeature

            feature "CK-TARGET-MATCH";
                description = "地址匹配检测点。验证实际计算的目标地址（PC+jumpOffset）与预测目标地址的比较逻辑"
            endfeature

            feature "CK-TARGET-FAULT";
                description = "目的地址错误检测点。验证目的地址预测错误的检测和记录，只统计不纠正（相信预测器）"
            endfeature
        endfeature
    endfeature

    # ========================================
    # Uncache指令处理功能分组
    # ========================================
    feature "FG-UNCACHE";
        description = "Uncache指令处理功能分组。处理MMIO指令和不可缓存指令的取指，包含4状态FSM用于阻止MMIO指令的推测执行"

        feature "FC-UNCACHE-FSM";
            description = "Uncache状态机功能。实现4状态有限状态机（Idle、WaitLastCommit、SendReq、WaitResp），控制uncache指令取指流程"

            feature "CK-IDLE";
                description = "空闲状态检测点。验证Idle状态等待uncache请求的正确性，收到请求后根据是否MMIO转WaitLastCommit或SendReq"
            endfeature

            feature "CK-WAIT-COMMIT";
                description = "等待提交检测点。验证WaitLastCommit状态等待MMIO指令成为最旧指令的功能，通过mmioCommitRead接口查询FTQ"
            endfeature

            feature "CK-SEND-REQ";
                description = "发送请求检测点。验证SendReq状态向uncache总线发送取指请求的正确性，考虑ifuStall信号暂停"
            endfeature

            feature "CK-WAIT-RESP";
                description = "等待响应检测点。验证WaitResp状态接收uncache总线返回数据的正确性，提取数据和异常信息"
            endfeature

            feature "CK-STATE-TRANS";
                description = "状态转换检测点。验证FSM各状态之间的转换条件正确性，包括Idle→WaitLastCommit→SendReq→WaitResp→Idle"
            endfeature

            feature "CK-FIRST-INSTR";
                description = "第一条指令检测点。验证处理器执行的第一条指令绕过WaitLastCommit状态的逻辑，不存在更旧指令直接发送请求"
            endfeature
        endfeature

        feature "FC-UNCACHE-MMIO-BLOCK";
            description = "MMIO推测阻塞功能。阻止MMIO指令的推测执行，确保MMIO指令成为最旧指令后才发送uncache请求"

            feature "CK-MMIO-DETECT";
                description = "MMIO检测检测点。验证正确识别MMIO指令（isMmio信号）的逻辑，MMIO指令需要阻塞，非MMIO不需要"
            endfeature

            feature "CK-BLOCK-EFFECT";
                description = "阻塞生效检测点。验证MMIO指令被阻塞在WaitLastCommit状态，直到成为最旧指令才转到SendReq"
            endfeature

            feature "CK-COMMIT-QUERY";
                description = "提交查询检测点。验证mmioCommitRead接口向FTQ查询提交状态的功能，查询ftqIdx-1是否已提交"
            endfeature

            feature "CK-NON-MMIO";
                description = "非MMIO检测点。验证非MMIO的uncache指令不经过阻塞直接发送请求的正确性，直接从Idle转SendReq"
            endfeature
        endfeature

        feature "FC-UNCACHE-ADDR-CHECK";
            description = "Uncache地址检查功能。对uncache指令进行两次地址检查：ICache返回阶段的PMP/PBMT检查，uncache总线返回阶段的TileLink异常检查"

            feature "CK-STAGE1-PMP";
                description = "第一阶段PMP检测点。验证ICache返回时的PMP物理内存保护检查，确保访问权限合法"
            endfeature

            feature "CK-STAGE1-PBMT";
                description = "第一阶段PBMT检测点。验证ICache返回时的PBMT页内存类型检查，区分Normal、IO、Reserved类型"
            endfeature

            feature "CK-STAGE2-TILELINK";
                description = "第二阶段TileLink检测点。验证uncache总线返回时的TileLink异常检查，包括corrupt和denied信号"
            endfeature

            feature "CK-EXCEPTION-MIX";
                description = "异常混合检测点。验证两次检查的异常混合处理，包括5种场景：两次都异常、仅第一次异常、仅第二次异常等"
            endfeature

            feature "CK-CORRUPT";
                description = "corrupt异常检测点。验证总线返回corrupt信号时的异常处理，表示数据损坏"
            endfeature

            feature "CK-DENIED";
                description = "denied异常检测点。验证总线返回denied信号时的异常处理，表示访问被拒绝"
            endfeature
        endfeature

        feature "FC-UNCACHE-CROSSPAGE";
            description = "跨页处理功能。处理uncache指令跨越页边界的情况，包括数据拼接和重定向处理"

            feature "CK-CROSSPAGE-FLAG";
                description = "跨页标志检测点。验证crossPage标志的正确识别，incomplete信号表示指令跨越页边界"
            endfeature

            feature "CK-DATA-SPLIT";
                description = "数据拆分检测点。验证跨页时指令数据拆分为高16位和低16位的正确性，保存在prevUncacheData"
            endfeature

            feature "CK-DATA-MERGE";
                description = "数据拼接检测点。验证顺序取指时两个预测块数据拼接的正确性，Cat(newData(15,0), prevData)"
            endfeature

            feature "CK-REDIRECT-HANDLER";
                description = "重定向处理检测点。验证跨页时发生重定向的数据暂存和重定向发送的正确性，携带半截数据"
            endfeature
        endfeature
    endfeature

    # ========================================
    # Two Fetch功能分组
    # ========================================
    feature "FG-TWO-FETCH";
        description = "Two Fetch功能分组。支持在一个周期内获取两个预测块，提高指令取指带宽"

        feature "FC-TWO-FETCH-REQ";
            description = "双预测块请求功能。在满足条件时，向ICache请求两个连续的预测块"

            feature "CK-TWO-FETCH-COND";
                description = "双取条件检测点。验证满足Two Fetch条件时的双预测块请求，条件包括预测器顺序预测、ICache就绪、IBuffer未满等"
            endfeature

            feature "CK-FIRST-BLOCK";
                description = "第一个块检测点。验证第一个预测块的正常取指，从startPC开始取32字节"
            endfeature

            feature "CK-SECOND-BLOCK";
                description = "第二个块检测点。验证第二个预测块的正常取指，从startPC+32字节开始取32字节"
            endfeature

            feature "CK-CONTIGUOUS";
                description = "连续地址检测点。验证两个预测块的地址连续性，第二个块地址为第一个块地址+32字节"
            endfeature

            feature "CK-NON-TWO-FETCH";
                description = "非双取检测点。验证不满足条件时的单预测块取指，包括预测跳转、IBuffer满等情况"
            endfeature
        endfeature

        feature "FC-TWO-FETCH-MERGE";
            description = "双预测块拼接功能。将两个预测块的数据拼接成一个完整的fetch块进行处理"

            feature "CK-NORMAL-MERGE";
                description = "正常拼接检测点。验证两个预测块的正常拼接（32字节 + 32字节 = 64字节），按顺序拼接"
            endfeature

            feature "CK-CROSS-BLOCK";
                description = "跨预测块指令检测点。验证指令跨越两个预测块边界时的拼接处理，识别半条指令并正确拼接"
            endfeature

            feature "CK-VALID-MERGE";
                description = "有效拼接检测点。验证valid信号在两个预测块拼接时的正确性，两个块的有效指令拼接"
            endfeature

            feature "CK-ALIGNMENT";
                description = "对齐处理检测点。验证双预测块时的指令对齐处理，确保指令边界正确识别"
            endfeature
        endfeature
    endfeature

    # ========================================
    # 触发器功能分组
    # ========================================
    feature "FG-TRIGGER";
        description = "触发器功能分组。支持调试模式下的PC匹配触发，可以设置4个独立的触发器"

        feature "FC-TRIGGER-CONFIG";
            description = "触发器配置功能。配置4个tdata寄存器，包括比较值、匹配类型、触发时机等"

            feature "CK-TDATA-UPDATE";
                description = "tdata更新检测点。验证通过tUpdate接口更新tdata寄存器的功能，tUpdate.bits.addr指定更新哪个寄存器"
            endfeature

            feature "CK-ENABLE";
                description = "使能控制检测点。验证triggerEnableVec控制触发器使能的功能，每个触发器独立使能"
            endfeature

            feature "CK-TDATA1";
                description = "tdata1配置检测点。验证比较值1（PC低位部分）的配置和存储"
            endfeature

            feature "CK-TDATA2";
                description = "tdata2配置检测点。验证比较值2（PC高位部分）的配置和存储"
            endfeature

            feature "CK-TDATA3";
                description = "tdata3配置检测点。验证控制寄存器（select、matchType、timing、chain、action）的配置和存储"
            endfeature
        endfeature

        feature "FC-TRIGGER-MATCH";
            description = "PC匹配功能。遍历送入IBuffer的所有PC，根据matchType进行匹配，判断是否触发触发器"

            feature "CK-SINGLE-MATCH";
                description = "单触发器匹配检测点。验证单个触发器PC匹配的正确性，PC拆分后与tdata1和tdata2比较"
            endfeature

            feature "CK-MULTI-MATCH";
                description = "多触发器匹配检测点。验证多个触发器同时匹配的情况，多个触发器可以同时匹配"
            endfeature

            feature "CK-MATCHTYPE";
                description = "匹配类型检测点。验证不同matchType（=、!=、<、>、>=、<=等）的匹配规则"
            endfeature

            feature "CK-SELECT";
                description = "select标志检测点。验证select标志对匹配的影响，select=false时才进行地址匹配"
            endfeature

            feature "CK-PC-PARTS";
                description = "PC拆分检测点。验证PC拆分为高位和低位进行匹配的正确性，使用PrunedAddr类型"
            endfeature
        endfeature

        feature "FC-TRIGGER-CHECK";
            description = "触发检查功能。综合考虑timing、chain、action等控制信号，检查触发器是否可以触发"

            feature "CK-CAN-FIRE";
                description = "可触发检查检测点。验证TriggerCheckCanFire检查触发器是否可触发的功能，综合timing和chain"
            endfeature

            feature "CK-TIMING";
                description = "timing控制检测点。验证触发时机控制的正确性，控制触发器在指令执行的哪个阶段触发"
            endfeature

            feature "CK-CHAIN";
                description = "chain链式检测点。验证多个触发器链式匹配的功能，前一个触发器触发后才检查后一个"
            endfeature

            feature "CK-ACTION";
                description = "action动作检测点。验证触发后动作类型的正确性，包括进入调试模式、触发断点异常等"
            endfeature

            feature "CK-BP-EXP";
                description = "断点异常检测点。验证triggerCanRaiseBpExp断点异常触发的正确性，生成断点异常信号"
            endfeature
        endfeature

        feature "FC-TRIGGER-DEBUG";
            description = "调试模式控制功能。控制触发器在调试模式和非调试模式下的行为"

            feature "CK-DEBUG-MODE";
                description = "调试模式检测点。验证进入调试模式后触发器停止匹配的功能，debugMode为true时不匹配"
            endfeature

            feature "CK-NON-DEBUG";
                description = "非调试模式检测点。验证非调试模式下触发器正常工作的功能，debugMode为false时正常匹配"
            endfeature

            feature "CK-MODE-SWITCH";
                description = "模式切换检测点。验证调试模式切换时的触发器行为，切换过程中不应该有意外触发"
            endfeature
        endfeature
    endfeature

    # ========================================
    # 冲刷控制功能分组
    # ========================================
    feature "FG-FLUSH-CTRL";
        description = "冲刷控制功能分组。处理外部冲刷信号，包括BPU冲刷、后端重定向、内部重定向等，控制流水线清空和状态恢复"

        feature "FC-FLUSH-BPU";
            description = "BPU冲刷处理功能。处理来自BPU的冲刷信号，包括S0级和S1级的BPU冲刷"

            feature "CK-S0-FLUSH";
                description = "S0级BPU冲刷检测点。验证S0级接收s0_flushFromBpu信号的冲刷功能，清空S0级状态"
            endfeature

            feature "CK-S1-FLUSH";
                description = "S1级BPU冲刷检测点。验证S1级接收s1_flushFromBpu信号的冲刷功能，清空S1级状态并向上传播"
            endfeature

            feature "CK-BPU-PROPAGATE";
                description = "BPU传播检测点。验证BPU冲刷信号向S2、S3级传播的正确性，S1→S2→S3逐级传播"
            endfeature
        endfeature

        feature "FC-FLUSH-BACKEND";
            description = "后端重定向处理功能。处理来自后端的重定向信号，具有最高优先级，可冲刷所有流水线级"

            feature "CK-BACKEND-VALID";
                description = "后端重定向有效检测点。验证backendRedirect信号有效时的冲刷功能，冲刷所有流水线级"
            endfeature

            feature "CK-HIGHEST-PRIORITY";
                description = "最高优先级检测点。验证backendRedirect的最高优先级，优先级高于BPU flush和内部重定向"
            endfeature

            feature "CK-ENQ-PTR-RESET";
                description = "指针复位检测点。验证后端重定向时s2_prevIBufEnqPtr复位为0的正确性，清空指针状态"
            endfeature

            feature "CK-PIPE-RESET";
                description = "流水线复位检测点。验证后端重定向时S0、S1、S2、S3所有级的寄存器复位的正确性"
            endfeature
        endfeature

        feature "FC-FLUSH-INTERNAL";
            description = "内部重定向处理功能。处理IFU内部产生的重定向信号，包括wbRedirect和uncacheRedirect"

            feature "CK-WB-VALID";
                description = "wbRedirect有效检测点。验证预译码检查器产生的wbRedirect信号处理，检测到预测错误时产生"
            endfeature

            feature "CK-WB-PTR";
                description = "wbRedirect指针检测点。验证wbRedirect携带的prevIBufEnqPtr指针更新的正确性，恢复到预测错误的指针"
            endfeature

            feature "CK-WB-COUNT";
                description = "wbRedirect计数检测点。验证wbRedirect携带的instrCount指令计数的正确性，记录预测块中的指令数"
            endfeature

            feature "CK-UNCACHE-VALID";
                description = "uncacheRedirect有效检测点。验证uncache完成产生的uncacheRedirect信号处理，uncache取指完成时产生"
            endfeature

            feature "CK-UNCACHE-PTR";
                description = "uncacheRedirect指针检测点。验证uncacheRedirect携带的prevIBufEnqPtr指针更新的正确性"
            endfeature

            feature "CK-INTERNAL-PROPAGATE";
                description = "内部传播检测点。验证内部重定向信号向各级传播的正确性，wb传播到S3，uncache传播到S3"
            endfeature
        endfeature

        feature "FC-FLUSH-PRIORITY";
            description = "冲刷优先级与传播功能。管理各种冲刷信号的优先级和传播规则"

            feature "CK-PRIORITY-ORDER";
                description = "优先级顺序检测点。验证冲刷优先级顺序（backendRedirect > wbRedirect/uncacheRedirect > BPU flush）"
            endfeature

            feature "CK-S3-FLUSH";
                description = "S3级冲刷检测点。验证S3级冲刷信号计算（backendRedirect || (wbRedirect.valid && !s3_wbNotFlush)）"
            endfeature

            feature "CK-S2-FLUSH";
                description = "S2级冲刷检测点。验证S2级冲刷信号计算（backendRedirect || uncacheRedirect.valid || wbRedirect.valid）"
            endfeature

            feature "CK-FLUSH-PROPAGATE";
                description = "冲刷传播检测点。验证冲刷信号从上游到下游的传播（S0→S1→S2→S3），逐级传播"
            endfeature

            feature "CK-FLUSH-BLOCK";
                description = "冲刷阻塞检测点。验证冲刷期间新请求被阻塞的正确性，冲刷期间不处理新的取指请求"
            endfeature
        endfeature

        feature "FC-FLUSH-RECOVERY";
            description = "冲刷后状态恢复功能。执行冲刷后的状态恢复操作，包括寄存器复位、指针复位、状态机复位等"

            feature "CK-REG-RESET";
                description = "寄存器复位检测点。验证流水线寄存器（S0、S1、S2、S3）的复位，清空所有流水线数据"
            endfeature

            feature "CK-STATE-RESET";
                description = "状态复位检测点。验证state寄存器（如uncacheState）的复位，恢复到初始状态"
            endfeature

            feature "CK-PTR-RESET";
                description = "指针复位检测点。验证IBuffer指针（prevIBufferEnqPtr）的复位，根据冲刷类型复位或更新"
            endfeature

            feature "CK-UNCACHE-RESET";
                description = "Uncache复位检测点。验证Uncache状态机调用uncacheReset()复位的正确性，清空uncache状态"
            endfeature
        endfeature
    endfeature

    # ========================================
    # 反压处理功能分组
    # ========================================
    feature "FG-BACKPRESSURE";
        description = "反压处理功能分组。处理ICache、IBuffer和uncache通路的反压信号，控制流水线暂停和恢复"

        feature "FC-BACKPRESSURE-ICACHE";
            description = "ICache反压处理功能。处理ICache多拍未响应时的反压情况"

            feature "CK-ICACHE-STALL";
                description = "ICache暂停检测点。验证ICache多拍未响应时IFU暂停S1级的正确性，s1_fire=false"
            endfeature

            feature "CK-ICACHE-RESUME";
                description = "ICache恢复检测点。验证ICache恢复响应后IFU恢复正常取指的正确性，s1_fire恢复为true"
            endfeature

            feature "CK-ICACHE-TIMEOUT";
                description = "ICache超时检测点。验证ICache长时间无响应的处理逻辑，确保不会死等"
            endfeature
        endfeature

        feature "FC-BACKPRESSURE-IBUFFER";
            description = "IBuffer反压处理功能。处理IBuffer满载时的反压情况，控制指令发送到IBuffer的速率"

            feature "CK-IBUF-FULL";
                description = "IBuffer满载检测点。验证IBuffer满载时S3级暂停发送指令的正确性，s3_fire=false"
            endfeature

            feature "CK-IBUF-READY";
                description = "IBuffer就绪检测点。验证IBuffer由满变空闲后IFU恢复发送的正确性，s3_fire恢复为true"
            endfeature

            feature "CK-IBUF-PTR";
                description = "IBuffer指针检测点。验证IBuffer指针与满载检测的一致性，prevIBufferEnqPtr与IBuffer状态同步"
            endfeature
        endfeature

        feature "FC-BACKPRESSURE-UNCACHE";
            description = "Uncache取指反压功能。处理uncache取指时的反压情况，通过uncacheReady信号控制"

            feature "CK-UNCACHE-NOTREADY";
                description = "uncache未就绪检测点。验证uncacheReady为false时暂停发送请求的正确性，toUncache.valid=false"
            endfeature

            feature "CK-UNCACHE-READY";
                description = "uncache就绪检测点。验证uncacheReady为true时恢复发送请求的正确性，toUncache.valid=true"
            endfeature

            feature "CK-UNCACHE-STALL";
                description = "uncache暂停检测点。验证ifuStall信号控制uncache暂停的正确性，SendReq状态暂停发送"
            endfeature
        endfeature

        feature "FC-BACKPRESSURE-PROPAGATE";
            description = "反压传播功能。管理反压信号在流水线中的传播链：S3→S2→S1→FTQ"

            feature "CK-S3-TO-S2";
                description = "S3到S2传播检测点。验证S3级反压向S2级传播的正确性，s3_stall导致s2_stall"
            endfeature

            feature "CK-S2-TO-S1";
                description = "S2到S1传播检测点。验证S2级反压向S1级传播的正确性，s2_stall导致s1_stall"
            endfeature

            feature "CK-S1-TO-FTQ";
                description = "S1到FTQ传播检测点。验证S1级反压向FTQ传播的正确性，s1_stall导致不接收FTQ请求"
            endfeature

            feature "CK-PROPAGATE-CHAIN";
                description = "传播链检测点。验证完整反压传播链（S3→S2→S1→FTQ）的正确性，逐级反压"
            endfeature
        endfeature

        feature "FC-BACKPRESSURE-FLUSH";
            description = "反压与冲刷交互功能。处理反压期间发生冲刷的复杂交互场景"

            feature "CK-FLUSH-DURING-STALL";
                description = "暂停期间冲刷检测点。验证反压期间收到冲刷信号的正确处理，冲刷优先级高于反压"
            endfeature

            feature "CK-FLUSH-AFTER-STALL";
                description = "暂停后冲刷检测点。验证反压解除后收到冲刷信号的正确处理，正常执行冲刷"
            endfeature

            feature "CK-STALL-AFTER-FLUSH";
                description = "冲刷后暂停检测点。验证冲刷后发生反压的正确处理，反压正常生效"
            endfeature

            feature "CK-PRIORITY";
                description = "优先级处理检测点。验证冲刷优先级高于反压的正确性，冲刷期间反压不生效"
            endfeature
        endfeature
    endfeature

    # ========================================
    # IBuffer接口功能分组
    # ========================================
    feature "FG-IBUF-IF";
        description = "IBuffer接口功能分组。处理IFU与IBuffer之间的接口，包括指针管理、数据对齐、RVC扩展等"

        feature "FC-IBUF-PTR";
            description = "prevIBufferEnqPtr指针管理功能。管理prevIBufferEnqPtr指针，跟踪IBuffer入队位置，确保与IBuffer协同工作的正确性"

            feature "CK-PTR-INIT";
                description = "指针初始化检测点。验证复位后prevIBufferEnqPtr初始化为0的正确性"
            endfeature

            feature "CK-PTR-NORMAL";
                description = "指针正常递增检测点。验证S2级正常取指时指针递增s2_instrCount的正确性，指针单调递增"
            endfeature

            feature "CK-PTR-BACKEND";
                description = "后端重定向指针检测点。验证backendRedirect时指针复位为0的正确性"
            endfeature

            feature "CK-PTR-WB";
                description = "wbRedirect指针检测点。验证wbRedirect时指针更新为wbRedirect.prevIBufEnqPtr + wbRedirect.instrCount的正确性"
            endfeature

            feature "CK-PTR-UNCACHE";
                description = "uncacheRedirect指针检测点。验证uncacheRedirect时指针更新为uncacheRedirect.prevIBufEnqPtr + uncacheRedirect.instrCount的正确性"
            endfeature

            feature "CK-PTR-MONOTONIC";
                description = "指针单调性检测点。验证指针单调递增不回绕（除重定向外）的正确性，确保与IBuffer同步"
            endfeature
        endfeature

        feature "FC-IBUF-ALIGN";
            description = "指令数据对齐功能。处理指令数据与IBuffer bank对齐，确保写入正确的IBuffer bank"

            feature "CK-ALIGN-CALC";
                description = "对齐计算检测点。验证根据enqPtr计算bank对齐的正确性，使用mod 4计算bank"
            endfeature

            feature "CK-ALIGN-S2";
                description = "S2级对齐检测点。验证S2级预计算prevIBufferEnqPtr的对齐，为S3级准备对齐指针"
            endfeature

            feature "CK-ALIGN-S3";
                description = "S3级对齐检测点。验证S3级使用对齐指针写入IBuffer的正确性，写入正确的bank"
            endfeature

            feature "CK-MOD-4";
                description = "mod 4计算检测点。验证bank对齐使用mod 4计算的正确性，4个bank轮流写入"
            endfeature
        endfeature

        feature "FC-IBUF-RVC";
            description = "RVC扩展功能。将16位RVC指令扩展为32位RVI指令，保持指令格式统一"

            feature "CK-RVC-EXPAND";
                description = "RVC扩展检测点。验证使用RocketChip RVCDecoder扩展RVC指令的正确性，生成32位RVI指令"
            endfeature

            feature "CK-INVALID-RVC";
                description = "非法RVC检测点。验证非法RVC指令保持原数据的正确性，不进行扩展"
            endfeature

            feature "CK-FSISOFF";
                description = "fsIsOff控制检测点。验证fsIsOff控制信号对RVC扩展的影响，控制浮点扩展"
            endfeature

            feature "CK-32BIT-OUTPUT";
                description = "32位输出检测点。验证输出32位RVI指令格式的正确性，所有指令统一为32位"
            endfeature
        endfeature

        feature "FC-IBUF-ENQUEUE";
            description = "IBuffer入队优化功能。优化IBuffer入队过程，包括Valid序列和enqEnable序列分离、写分bank策略等"

            feature "CK-VALID-SEQ";
                description = "Valid序列检测点。验证Valid序列与enqEnable序列分离的正确性，Valid标记指令有效"
            endfeature

            feature "CK-ENABLE-SEQ";
                description = "Enable序列检测点。验证enqEnable序列控制写入使能的正确性，Enable控制写入时机"
            endfeature

            feature "CK-WRITE-BANK";
                description = "写分bank检测点。验证写分bank策略（mod 4）的正确性，提高写入效率"
            endfeature

            feature "CK-ENQ-EFFICIENCY";
                description = "入队效率检测点。验证同时写入多条指令的效率优化，充分利用IBuffer带宽"
            endfeature
        endfeature
    endfeature

endplan
